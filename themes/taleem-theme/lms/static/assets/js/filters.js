var filtersSelected=[],filterSearch="",filterSort="",filtertPage=1,filtertAllPages=1;Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{value:function(e=1,t=[]){for(let r of this)r instanceof Array&&e>0?r.flat(e-1,t):t.push(r);return t}});const flatten=e=>Object.values(e).flat();function filterAddCourse(e){console.log("'filterAddCourse' function not implemented!")}function filterUpdatePagination(e,t){console.log("'filterUpdatePagination' function not implemented!")}function filterUpdateSuggestionMsg(e,t){console.log("'filterUpdateSuggestionMsg' function not implemented!")}function filterCoursesUpdated(){console.log("'filterCoursesUpdated' function not implemented!")}function filterLoadCourses(e,t,r,l,o=!0){let i=e;o&&(i=flatten(e)),console.log(i);let a=new URLSearchParams({filters:i,search:t,sort:r,page:l});window.history.replaceState(null,null,window.location.pathname+"?"+a),$("#courses-wrapper").addClass("loading");jQuery.ajax({type:"GET",url:"/search/filtered_course/",data:{filters:i.join(),search:t,sort:r,page:l},success:function(o){console.log(o),filtersSelected=e,filterSearch=t,filterSort=r,filtertPage=l,filtertAllPages=o.total_num_of_pages,$("#courses-wrapper .courses-listing").empty();let i=o.courses;for(var a in i.forEach((e=>filterAddCourse(e))),filterUpdatePagination(o.total_num_of_pages,filtertPage),filterUpdateSuggestionMsg(o.is_recommened_courses,o.weightage_category),filtersSelected)if(filtersSelected.hasOwnProperty(a)){let e=filtersSelected[a];e.length>0?($("#"+a+"-counter").text(e.length),$("#"+a+"-counter").addClass("show")):($("#"+a+"-counter").text(0),$("#"+a+"-counter").removeClass("show"))}$("#filter-accordion .filter-header").addClass("collapsed"),$("#filter-accordion .collapse").removeClass("show"),$("#filter-pages .page").removeClass("active"),$("#filter-pages .page[data-page="+filtertPage+"]").addClass("active"),filterCoursesUpdated(),$("html, body").animate({scrollTop:$(".courses-container").offset().top},500)},error:function(e){console.error(e.statusText+e.responseText),alert("Error occured. please try again")},complete:function(){$("#courses-wrapper").removeClass("loading")}})}function filterCollect(){let e=[];$(".courses-filter .filter-card").each((function(t){let r=$(this).data("filter"),l=$("#"+r+"-filter input:checkbox:checked").map((function(){return $(this).val()})).get();console.log("Filter "+r+": "+l),e[r]=l}));let t=$("#search-filter input").val()||"",r=$("#sort-filter select").val()||"";filterLoadCourses(e,t,r,1)}function isAnySelectedFilter(){let e=[];$(".courses-filter .filter-card").each((function(t){let r=$(this).data("filter"),l=$("#"+r+"-filter input:checkbox:checked").map((function(){return $(this).val()})).get();e[r]=l}));let t=flatten(e),r=$("#search-filter input").val()||"",l=$("#sort-filter select").val()||"";return t.length>0||""!=r||""!=l}$(document).ready((function(){if(window.location.search){const e=new URLSearchParams(window.location.search);filterLoadCourses(e.get("filters")!=null&&e.get("filters").split(",")||[],e.get("search")!=null&&e.get("search")||"",e.get("sort")!=null&&e.get("sort")||"",e.get("page")!=null&&e.get("page")||1,should_flatten=!1)}$("#filter-btn").on("click",(function(){filterCollect()})),$(document).keypress((function(e){"13"==(e.keyCode?e.keyCode:e.which)&&isAnySelectedFilter()&&$("#filter-btn").click()})),document.getElementById("filters-auto-complete").addEventListener("keyup",(function(e){13===e.keyCode&&$("#filter-btn").click()})),$("#filter-prev").on("click",(function(){filtertPage>1&&filterLoadCourses(filtersSelected,filterSearch,filterSort,filtertPage-1)})),$("#filter-next").on("click",(function(){filtertPage<filtertAllPages&&filterLoadCourses(filtersSelected,filterSearch,filterSort,filtertPage+1)})),$("#filter-pages .page").on("click",(function(){let e=parseInt($(this).data("page"));e>0&&e<=filtertAllPages&&filterLoadCourses(filtersSelected,filterSearch,filterSort,e)})),$(".filter-input").on("change",(function(){isAnySelectedFilter()&&$("#filter-btn").click()}))}));
