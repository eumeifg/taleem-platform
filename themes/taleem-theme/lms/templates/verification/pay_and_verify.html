<%page expression_filter="h"/>
<%!
import json
from django.utils.translation import ugettext as _

from openedx.core.djangolib.markup import HTML, Text
from lms.djangoapps.verify_student.views import PayAndVerifyView
%>
<%namespace name='static' file='../static_content.html'/>

<%inherit file="../main.html" />
<%block name="bodyclass">register verification-process step-requirements</%block>

<%block name="pagetitle">
  % if message_key == PayAndVerifyView.UPGRADE_MSG:
    ${_("Upgrade Your Identification")}
  % elif message_key in [PayAndVerifyView.VERIFY_NOW_MSG, PayAndVerifyView.VERIFY_LATER_MSG]:
    ${_("Verify Your Identification")}
  % endif
</%block>

<%block name="header_extras">
    <%
      template_names = (
          ["webcam_photo", "image_input", "error", "intro_step"] +
          ["face_photo_step", "id_photo_step", "review_photos_step", "enrollment_confirmation_step"]
      )
      template_name_with_user_type = (
          ["intro_step", "enrollment_confirmation_step", "id_photo_step", "face_photo_step"]
      )
    %>

    % for template_name in template_names:
        <script type="text/template" id="${template_name}-tpl">
            %if template_name in template_name_with_user_type:
                <%static:include path="verification/${user_type}/${template_name}.underscore" />
            %else:
                <%static:include path="verify_student/${template_name}.underscore" />
            %endif
        </script>
    % endfor
</%block>
<%block name="js_extra">
  <script src="${static.url('js/src/tooltip_manager.js')}"></script>
  <%static:js group='verification'/>
</%block>

<%block name="content">
## Top-level wrapper for errors
## JavaScript views may append to this wrapper
<div id="error-container" style="display: none;"></div>

<div class="container no-min-scale">
  <section class="wrapper carousel">
    ## Payment / Verification flow
    ## Most of these data attributes are used to dynamically render
    ## the steps, but some are just useful for A/B test setup.
    <div
      id="pay-and-verify-container"
      class="pay-and-verify"
      data-full-name='${user_full_name}'
      data-platform-name='${platform_name}'
      data-display-steps='${json.dumps(display_steps)}'
      data-current-step='${current_step}'
      data-requirements='${json.dumps(requirements)}'
      data-msg-key='${message_key}'
      data-is-active='${is_active}'
      data-user-email='${user_email}'
      data-user-language='${user_language}'
      data-user-timezone='${user_timezone}'
      data-capture-sound='${capture_sound}'
    ></div>

    % if is_active:
    ## Support
    <div class="wrapper-content-supplementary">
      <aside class="content-supplementary">
          <ul class="list-help">
              <%include file="../verify_student/_verification_help.html" />

              % if PayAndVerifyView.WEBCAM_REQ in requirements:
              <li class="help-item help-item-technical">
                  <h3 class="title">${_("Technical Requirements")}</h3>
                  <div class="copy">
                      <p>${Text(_("Please make sure your browser is updated to the {strong_start}{a_start}most recent version possible{a_end}{strong_end}. Also, please make sure your {strong_start}webcam is plugged in, turned on, and allowed to function in your web browser (commonly adjustable in your browser settings).{strong_end}")).format(
                              a_start=HTML('<a rel="external" href="http://browsehappy.com/">'),
                              a_end=HTML('</a>'),
                              strong_start=HTML('<strong>'),
                              strong_end=HTML('</strong>'))}</p>
                  </div>
              </li>
              % endif
          </ul>
        </aside>
    </div>
    % endif

  </section>
</div>
</%block>
