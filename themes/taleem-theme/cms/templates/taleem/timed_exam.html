<%page expression_filter="h"/>
<%!
import six
from django.utils.translation import ugettext as _

from openedx.core.djangolib.markup import HTML, Text
from openedx.core.djangolib.js_utils import (
      dump_js_escaped_json
  )
from openedx.custom.utils import utc_datetime_to_local_datetime
from django.urls import reverse
%>

<%inherit file="../base.html" />
<%namespace name='static' file='../static_content.html'/>
<%def name="online_help_token()"><% return "home" %></%def>
<%block name="title">${_("Timed Exam")} | ${_("{timed_exam_name}".format(timed_exam_name=timed_exam_model_instance.display_name))}</%block>
<%block name="bodyclass">is-signedin index view-dashboard</%block>

<%block name="requirejs">
  require(["js/factories/edit_timed_exam"], function (IndexFactory) {
      IndexFactory();
  });
</%block>

<%block name="header_extras">
    <link rel="stylesheet" type="text/css" href="${static.url('js/vendor/timepicker/jquery.timepicker.css')}" />
    <style type="text/css">
      .form-create .list-input .field-group .field.timed-exam-field {width: 49%;}
      #round {width: 94%;}
    </style>

</%block>

<%block name="content">
<div class="wrapper-mast wrapper">
  <header class="mast has-actions">
    <h1 class="page-header">${_("Timed Exam Details")}</h1>
    <nav class="nav-actions" aria-label="Page Actions">
        <h3 class="sr">Page Actions</h3>
        <ul>
          <li class="nav-item action-item">
              <a href="${reverse('home')}" class="button new-button">
                  <span class="icon fa fa-arrow-left icon-inline" aria-hidden="true"></span> <span class="action-button-text">${_("Go to Dashboard")}</span>
              </a>
          </li>
        </ul>
    </nav>

  </header>
</div>

<div class="wrapper-content wrapper">
  % if user.is_active:
  <section class="content">
    <article class="content-primary" role="main">

        <!-- Modal HTML embedded directly into document -->
        <div id="stickyModal" class="jqueryModal">
          <h2>${_('Please fix the following issues by selecting a correct count of questions for easy, moderate and hard questions.')}</h2>

            <br />

            <ol class="errors-wrapper" style="color: darkred; list-style: square outside none">

            </ol>

            <br />
          <a href="#" class="btn-brand btn-base" rel="modal:close" style="float: right; background-color: #DC143C; margin-left: 10px;">${_('Cancel')}</a>
          <a href="#" class="btn-brand btn-base" id="save-ignoring-errors" rel="modal:close" style="float: right; background-color: green">${_('Proceed')}</a>
        </div>

      <div class="wrapper-edit-element wrapper-edit-timed-exam">
        <form class="form-create create-timed-exam timed-exam-info" id="create-timed-exam-form" name="create-timed-exam-form">
          <div class="wrap-error">
            <div id="timed-exam-creation-error" name="timed-exam-creation-error" class="message message-status message-status error" role="alert">
                <p>${_("Please correct the highlighted fields below.")}</p>
            </div>
            % if messages:
              <div class="message success message-status message-success" style="background: #2C1C59; display: block">
                % for message in messages:
                  % if message.tags:
                    <p class="${message.tags}">${message}</p>
                  % else:
                    <p>${message}</p>
                  % endif
                % endfor
              </div>
            % endif

          </div>
          <div class="wrapper-form">
            <fieldset>
              <legend class="sr">${_("Required Information to Create a Timed Exam")}</legend>

              <ol class="list-input">
                <li class="field text required" id="field-timed-exam-name">
                  <label for="new-timed-exam-name">${_("Timed Exam Name")}</label>
                  ## Translators: This is an example name for a new timed exam, seen when
                  ## filling out the form to create a timed exam.
                  ## (A library is a collection of content or problems.)
                  <input class="new-timed-exam-name" id="new-timed-exam-name" value="${timed_exam_model_instance.display_name}" type="text" name="new-timed-exam-name" required placeholder="${_('e.g. Computer Science Exam')}" aria-describedby="tip-new-timed-exam-name tip-error-new-timed-exam-name" />
                  <span class="tip" id="tip-new-timed-exam-name">${_("The public display name for your timed exam.")}</span>
                  <span class="tip tip-error is-hiding" id="tip-error-new-timed-exam-name"></span>
                </li>
                <li class="field text required">
                  <label for="question-bank">${_("Question Bank")}</label>
                  <select class="question-bank select2" value="${timed_exam_model_instance.question_bank}" data-placeholder="${_('e.g. Question Bank for Computer Science')}" id="question-bank" name="question-bank" required aria-describedby="tip-question-bank tip-error-question-bank">
                      <option></option>
                      %for library in libraries:
                        %if library['library_key'] == timed_exam_model_instance.question_bank:
                            <option value="${library['library_key']}" selected>${library['display_name']} - ${library['org']} - ${library['grade']}</option>
                        %else:
                            <option value="${library['library_key']}">${library['display_name']} - ${library['org']} - ${library['grade']}</option>
                        %endif
                      %endfor
                  </select>

                  <span class="tip" id="tip-question-bank">${_("The question bank for your timed exam.")} ${_("This cannot be changed.")}</span>
                  <span class="tip tip-error is-hiding" id="tip-error-question-bank"></span>
                </li>

                <%
                  start_date = utc_datetime_to_local_datetime(timed_exam_model_instance.release_date)
                  end_date = utc_datetime_to_local_datetime(timed_exam_model_instance.due_date)
                %>
                <li class="field-group field-group-course-start" id="exam-start">
                  <div class="field date timed-exam-field" id="field-exam-start-date">
                    <label for="exam-start-date">${_("Exam Start Date")}</label>
                    <input type="text" class="start-date date start datepicker" id="exam-start-date"
                      value="${start_date.strftime('%d-%m-%Y')}" placeholder="DD-MM-YYYY" autocomplete="off" />
                    <span class="tip tip-stacked">${_("First day the exam begins")}</span>
                  </div>

                  <div class="field time timed-exam-field" id="field-exam-start-time">
                    <label for="exam-start-time">${_("Exam Start Time")}</label>
                    <input type="text" class="time start timepicker" id="exam-start-time"
                      value="${start_date.strftime('%H:%M')}" placeholder="HH:MM" autocomplete="off" />
                    <span class="tip tip-stacked timezone">${_("(Asia/Baghdad)")}</span>
                  </div>
                </li>

                <li class="field-group field-group-course-end" id="exam-end">
                  <div class="field date timed-exam-field" id="field-exam-end-date">
                    <label for="exam-end-date">${_("Exam End Date")}</label>
                    <input type="text" class="end-date date end datepicker" id="exam-end-date"
                      value="${end_date.strftime('%d-%m-%Y')}" placeholder="DD-MM-YYYY" autocomplete="off" />
                    <span class="tip tip-stacked">${_("Last day your exam is active")}</span>
                  </div>

                  <div class="field time timed-exam-field" id="field-exam-end-time">
                    <label for="exam-end-time">${_("Exam End Time")}</label>
                    <input type="text" class="time end timepicker" id="exam-end-time"
                      value="${end_date.strftime('%H:%M')}" placeholder="HH:MM" autocomplete="off" />
                    <span class="tip tip-stacked timezone">${_("(Asia/Baghdad)")}</span>
                  </div>
                </li>

                <li class="field-group field-group-skill-round">
                    <div class="field date timed-exam-field" id="field-exam-skill">
                        <label for="skill">${_("Skill")}</label>
                        <select class="skill select2" data-placeholder="${_('e.g. Programming')}" id="skill" name="skill" required aria-describedby="tip-skill tip-error-skill">
                            <option></option>
                            %for skill in skills:
                              % if timed_exam_model_instance.skill.name == skill['name'] :
                                  <option value="${skill['id']}" selected>${skill['name']}</option>
                              % else:
                                  <option value="${skill['id']}">${skill['name']}</option>
                              %endif:
                            %endfor
                         </select>

                        <span class="tip" id="tip-skill">${_("The skill your timed exam would help students learn.")}</span>
                        <span class="tip tip-error is-hiding" id="tip-error-skill"></span>
                    </div>
                    <div class="field date timed-exam-field" id="field-exam-round">
                         <label for="round">${_("Round")}</label>
                        <input class="round" id="round" type="number" min="1"  max="10" value="${timed_exam_model_instance.round}" name="round" required aria-describedby="tip-round tip-error-round" />

                        <span class="tip" id="tip-round">${_("The round of the timed exam.")}</span>
                        <span class="tip tip-error is-hiding" id="tip-error-round"></span>
                    </div>
                </li>

                <div class="bootstrap-iso">
                  <div class="row my-4">
                    <div class="col-6">
                      <li class="field text required" id="field-timed-exam-time-allotted">
                        <label for="timed-exam-time-allotted">${_("Time Allotted (HH:MM):")}</label>
                        ## Translators: This shows the allotted time for the exam
                        <input class="timed-exam-time-allotted time input input-text ui-timepicker-duration timepicker ui-timepicker-input" id="timed-exam-time-allotted" type="text" value="${timed_exam_model_instance.allotted_time}" autocomplete="off" name="timed-exam-time-allotted" required aria-describedby="tip-timed-exam-time-allotted tip-error-timed-exam-time-allotted" />
                        <span class="tip" id="tip-timed-exam-time-allotted">${_("This shows the allotted time for the exam.")}</span>
                        <span class="tip tip-error is-hiding" id="tip-error-timed-exam-time-allotted"></span>
                      </li>
                    </div>

                    <div class="col-6">
                      <li class="field text required" id="field-allowed-disconnection-window">
                        <label for="allowed-disconnection-window">${_("Allowed Disconnection Window (HH:MM):")}</label>
                        ## Translators: This shows the allowed disconnection duration for the exam.
                        <input class="allowed-disconnection-window time input input-text ui-timepicker-duration timepicker ui-timepicker-input" id="allowed-disconnection-window" type="text" value="${timed_exam_model_instance.allowed_disconnection_window}" autocomplete="off" name="allowed-disconnection-window" required aria-describedby="tip-allowed-disconnection-window tip-error-allowed-disconnection-window" />
                        <span class="tip" id="tip-allowed-disconnection-window">${_("This shows the allowed disconnection duration for the exam.")}</span>
                        <span class="tip tip-error is-hiding" id="tip-error-allowed-disconnection-window"></span>
                      </li>
                    </div>
                  </div>

                  <div class="row my-4">
                    <div class="col-6">
                      <li class="field text required" id="field-timed-exam-randomized">
                        <label for="is-randomized">${_("Randomized ?")}</label>
                        ## Translators: This shows whether or not the questions should be randomized
                        <select class="is-randomized select2" id="is-randomized" name="is-randomized" required aria-describedby="tip-is-randomized tip-error-is-randomized">
                          <option></option>
                            % if timed_exam_model_instance.is_randomized:
                              <option value="1" selected>${_("Yes")}</option>
                              <option value="0">${_("No")}</option>
                            %else:
                              <option value="1">${_("Yes")}</option>
                              <option value="0" selected>${_("No")}</option>
                            %endif
                        </select>
                        <span class="tip" id="tip-is-randomized">${_("No means the same question set will be assigned to all learners.")}</span>
                        <span class="tip tip-error is-hiding" id="tip-error-is-randomized"></span>
                      </li>
                    </div>

                    <div class="col-6">
                      <li class="field text required" id="field-timed-exam-bidirectional">
                      <label for="is-bidirectional">${_("Bidirectional ?")}</label>
                      ## Translators: This checkbox allows the user to specify if the timed exam is bidirectional or not.
                      <select class="is-bidirectional select2" id="is-bidirectional" name="is-bidirectional" required aria-describedby="tip-is-bidirectional tip-error-is-bidirectional">
                        <option></option>
                        % if timed_exam_model_instance.is_bidirectional:
                            <option value="1" selected>${_("Yes")}</option>
                            <option value="0">${_("No")}</option>
                        %else:
                            <option value="1">${_("Yes")}</option>
                            <option value="0" selected>${_("No")}</option>
                        %endif
                      </select>
                      <span class="tip" id="tip-is-bidirectional">${_("This checkbox allows the user to specify if students can navigate through the questions in the timed exam or not.")}</span>
                      <span class="tip tip-error is-hiding" id="tip-error-is-bidirectional"></span>
                    </li>
                  </div>
                </div>

                <div class="row my-4">
                  <div class="col-6">
                    <li class="field text" id="field-timed-exam-mode">
                      <label for="exam-mode">${_("Mode of Examination")}</label>
                      <select class="exam-mode select2" id="exam-mode" name="exam-mode" aria-describedby="tip-exam-mode tip-error-exam-mode">
                        % if timed_exam_model_instance.mode == 'ON':
                            <option value="ON" selected>${_("Online")}</option>
                            <option value="OF">${_("Offline")}</option>
                        % else:
                            <option value="ON">${_("Online")}</option>
                            <option value="OF" selected>${_("Offline")}</option>
                        % endif
                      </select>
                      <span class="tip" id="tip-exam-mode">${_("Internet connection requirement.")}</span>
                      <span class="tip tip-error is-hiding" id="tip-error-exam-mode"></span>
                    </li>
                  </div>
                  <div class="col-6">
                    <li class="field text required" id="field-timed-exam-enable-monitoring">
                      <label for="enable-monitoring">${_("Enable Monitoring ?")}</label>
                      <select class="enable-monitoring select2" id="enable-monitoring" name="enable-monitoring" required aria-describedby="tip-enable-monitoring tip-error-enable-monitoring">
                        <option></option>
                        % if timed_exam_model_instance.enable_monitoring:
                            <option value="1" selected>${_("Yes")}</option>
                            <option value="0">${_("No")}</option>
                          %else:
                            <option value="1">${_("Yes")}</option>
                            <option value="0" selected>${_("No")}</option>
                          %endif
                      </select>
                      <span class="tip" id="tip-enable-monitoring">${_("Whether to enable the timed exam monitoring or not.")}</span>
                      <span class="tip tip-error is-hiding" id="tip-error-enable-monitoring"></span>
                    </li>
                  </div>
                </div>

                <div class="row my-4">
                  <div class="col-6">
                    <li class="field text required" id="field-timed-exam-generate-enrollment-code">
                      <label for="generate-enrollment-code">${_("Generate Enrollment Code ?")}</label>
                      <select class="generate-enrollment-code select2" id="generate-enrollment-code" name="generate-enrollment-code" required aria-describedby="tip-generate-enrollment-code tip-error-generate-enrollment-code">
                        <option></option>
                        % if timed_exam_model_instance.generate_enrollment_code:
                            <option value="1" selected>${_("Yes")}</option>
                            <option value="0">${_("No")}</option>
                          %else:
                            <option value="1">${_("Yes")}</option>
                            <option value="0" selected >${_("No")}</option>
                          %endif
                      </select>
                      <span class="tip" id="tip-generate-enrollment-code">${_("Whether to enforce students to start this exam by adding a secret enrollment code.")}</span>
                      <span class="tip tip-error is-hiding" id="tip-error-generate-enrollment-code"></span>
                    </li>
                  </div>
                  <div class="col-6">
                    <li class="field text" id="field-timed-exam-type">
                      <label for="exam-type">${_("Type of Examination")}</label>
                      <select class="exam-type select2" id="exam-type" name="exam-type" aria-describedby="tip-exam-type tip-error-exam-type">
                          % if timed_exam_model_instance.exam_type == 'Public':
                              <option value="Public" selected>${_("Public")}</option>
                              <option value="Invite only">${_("Invite only")}</option>
                          %else:
                              <option value="Public">${_("Public")}</option>
                              <option value="Invite only" selected>${_("Invite only")}</option>
                          %endif
                      </select>
                      <span class="tip" id="tip-exam-type">${_("Do you want to make this exam public or keep it private with invite only.")}</span>
                      <span class="tip tip-error is-hiding" id="tip-error-exam-type"></span>
                    </li>
                  </div>
                </div>

                <div class="row my-4">
                  <div class="col-6">
                    <li class="field text required" id="field-timed-exam-question-count-of-easy-difficulty">
                      <label for="question-count-of-easy-difficulty">${_("Number of Easy Questions")}</label>
                      ## Translators: Available number of easy questions.
                      <input class="question-count-of-easy-difficulty" id="question-count-of-easy-difficulty" type="number" min="0" max="${question_bank_stats['easy']}" value="${timed_exam_model_instance.easy_question_count}" name="question-count-of-easy-difficulty" ${"" if question_bank_stats['easy'] > 0 else "disabled"} required aria-describedby="tip-question-count-of-easy-difficulty tip-error-question-count-of-easy-difficulty" />
                      <span class="tip" id="tip-question-count-of-easy-difficulty">
                          &nbsp;<span id="tip-available-easy-questions">${_("Available number of easy questions is {count}").format(count=question_bank_stats['easy'])}</span>
                      </span>
                      <span class="tip tip-error is-hiding" id="tip-error-question-count-of-easy-difficulty"></span>
                    </li>
                  </div>

                  <div class="col-6">
                    <li class="field text required" id="field-optional-easy-question-count">
                      <label for="optional-easy-question-count">${_("Optional Easy Questions")}</label>
                      ## Translators: This is the count of optional easy questions.
                      <input class="optional-easy-question-count" data-has-same-weightage="${'true' if question_bank_stats['has_same_weightage'] else 'false'}" id="optional-easy-question-count" ${"" if question_bank_stats['has_same_weightage'] and timed_exam_model_instance.easy_question_count > 0 else "disabled"} type="number" min="0" max="${question_bank_stats['easy']}" value="${timed_exam_model_instance.optional_easy_question_count}" name="optional-easy-question-count" required aria-describedby="tip-optional-easy-question-count tip-error-optional-easy-question-count" />
                      <span class="tip" id="tip-optional-easy-question-count">${_("This is the count of optional easy questions.")}</span>
                      <span class="tip tip-error is-hiding" id="tip-error-optional-easy-question-count"></span>
                    </li>
                  </div>
                </div>

                <div class="row my-4">
                  <div class="col-6">
                    <li class="field text required" id="field-timed-exam-question-count-of-medium-difficulty">
                      <label for="question-count-of-medium-difficulty">${_("Number of Moderate Difficulty Questions")}</label>
                      ## Translators: Available number of moderate questions.
                      <input class="question-count-of-medium-difficulty" id="question-count-of-medium-difficulty" type="number" min="0" max="${question_bank_stats['moderate']}" value="${timed_exam_model_instance.moderate_question_count}" name="question-count-of-medium-difficulty" ${"" if question_bank_stats['moderate'] > 0 else "disabled"} required aria-describedby="tip-question-count-of-medium-difficulty tip-error-question-count-of-medium-difficulty" />
                      <span class="tip" id="tip-question-count-of-medium-difficulty">
                          &nbsp;<span id="tip-available-medium-questions">${_("Available number of moderate questions is {count}").format(count=question_bank_stats['moderate'])}</span>
                      </span>
                      <span class="tip tip-error is-hiding" id="tip-error-question-count-of-medium-difficulty"></span>
                    </li>
                  </div>

                  <div class="col-6">
                    <li class="field text required" id="field-optional-medium-question-count">
                    <label for="optional-medium-question-count">${_("Optional Moderate Questions")}</label>
                    ## Translators: This is the count of optional moderate questions.
                    <input class="optional-medium-question-count" data-has-same-weightage="${'true' if question_bank_stats['has_same_weightage'] else 'false'}" id="optional-medium-question-count" ${"" if question_bank_stats['has_same_weightage'] and timed_exam_model_instance.moderate_question_count > 0 else "disabled"} type="number" min="0" max="${question_bank_stats['moderate']}" value="${timed_exam_model_instance.optional_moderate_question_count}" name="optional-medium-question-count" required aria-describedby="tip-optional-medium-question-count tip-error-optional-medium-question-count" />
                    <span class="tip" id="tip-optional-medium-question-count">${_("This is the count of optional moderate questions.")}</span>
                    <span class="tip tip-error is-hiding" id="tip-error-optional-medium-question-count"></span>
                  </li>
                </div>
              </div>

              <div class="row my-4">
                <div class="col-6">
                  <li class="field text required" id="field-timed-exam-question-count-of-hard-difficulty">
                    <label for="question-count-of-hard-difficulty">${_("Number of Hard Questions")}</label>
                    ## Translators: Available number of hard questions.
                    <input class="question-count-of-hard-difficulty" id="question-count-of-hard-difficulty" type="number" min="0" max="${question_bank_stats['hard']}" value="${timed_exam_model_instance.hard_question_count}" name="question-count-of-hard-difficulty" ${"" if question_bank_stats['hard'] > 0 else "disabled"} required aria-describedby="tip-question-count-of-hard-difficulty tip-error-question-count-of-hard-difficulty" />
                    <span class="tip" id="tip-question-hard-of-hard-difficulty">
                        &nbsp;<span id="tip-available-hard-questions">${_("Available number of hard questions is {count}").format(count=question_bank_stats['hard'])}</span>
                    </span>
                    <span class="tip tip-error is-hiding" id="tip-error-question-count-of-hard-difficulty"></span>
                  </li>
                </div>

                <div class="col-6">
                  <li class="field text required" id="field-optional-hard-question-count">
                    <label for="optional-hard-question-count">${_("Optional Hard Questions")}</label>
                    ## Translators: This is the count of optional hard questions.
                    <input class="optional-hard-question-count" data-has-same-weightage="${'true' if question_bank_stats['has_same_weightage'] else 'false'}" id="optional-hard-question-count" ${"" if question_bank_stats['has_same_weightage'] and timed_exam_model_instance.hard_question_count > 0 else "disabled"} type="number" min="0" max="${question_bank_stats['hard']}" value="${timed_exam_model_instance.optional_hard_question_count}" name="optional-hard-question-count" required aria-describedby="tip-optional-hard-question-count tip-error-optional-hard-question-count" />
                    <span class="tip" id="tip-optional-hard-question-count">${_("This is the count of optional hard questions.")}</span>
                    <span class="tip tip-error is-hiding" id="tip-error-optional-hard-question-count"></span>
                  </li>
                </div>
              </div>

                <li class="field text chapters-input">
                  <label for="chapters">${_("Chapters")}</label>

                  <input class="chapters_include_exclude" type="radio" id="chapters_include_all" name="chapters_include_exclude" value="all" ${"checked" if timed_exam_model_instance.chapters_include_exclude == "all" else ""}>
                  <label class="chapters_include_exclude" for="chapters_include_all">${_("All")}</label>
                  &nbsp;&nbsp;&nbsp;
                  <input class="chapters_include_exclude" type="radio" id="chapters_include" name="chapters_include_exclude" value="include" ${"checked" if timed_exam_model_instance.chapters_include_exclude == "include" else ""}>
                  <label class="chapters_include_exclude" for="chapters_include">${_("Include")}</label>
                  &nbsp;&nbsp;&nbsp;

                  <input class="chapters_include_exclude" type="radio" id="chapters_exclude" name="chapters_include_exclude" value="exclude" ${"checked" if timed_exam_model_instance.chapters_include_exclude == "exclude" else ""}>
                  <label class="chapters_include_exclude" for="chapters_exclude">${_("Exclude")}</label>
                  &nbsp;&nbsp;&nbsp;

                  <select class="chapters select2" id="chapters" multiple="multiple data-placeholder="${_('Chapters to include or exclude')}" name="chapters[]" aria-describedby="tip-chapters tip-error-chapters">
                      <option></option>
                      %for chapter in chapters:
                        <option ${"selected" if chapter['id'] in selected_values['chapters'] else ""} value="${chapter['id']}">${chapter['text']}</option>
                      %endfor
                  </select>

                  <span class="tip" id="tip-chapter">${_("The Chapters to include or exclude from the timed exam.")} ${_("This cannot be changed.")}</span>
                  <span class="tip tip-error is-hiding" id="tip-error-chapter"></span>
                </li>
                <li class="field text topics-input">
                  <label for="topics">${_("Topics")}</label>

                  <input class="topics_include_exclude" type="radio" id="topics_include_all" name="topics_include_exclude" checked value="all" ${"checked" if timed_exam_model_instance.topics_include_exclude == "all" else ""}>
                  <label class="topics_include_exclude" for="topics_include_all">${_("All")}</label>
                  &nbsp;&nbsp;&nbsp;
                  <input class="topics_include_exclude" type="radio" id="topics_include" name="topics_include_exclude" value="include" ${"checked" if timed_exam_model_instance.topics_include_exclude == "include" else ""}>
                  <label class="topics_include_exclude" for="topics_include">${_("Include")}</label>
                  &nbsp;&nbsp;&nbsp;

                  <input class="topics_include_exclude" type="radio" id="topics_exclude" name="topics_include_exclude" value="exclude" ${"checked" if timed_exam_model_instance.topics_include_exclude == "exclude" else ""}>
                  <label class="topics_include_exclude" for="topics_exclude">${_("Exclude")}</label>
                  &nbsp;&nbsp;&nbsp;

                  <select class="topics select2" id="topics" multiple="multiple data-placeholder="${_('Topics to include or exclude')}" name="topics[]" aria-describedby="tip-topics tip-error-topics">
                      <option></option>
                      %for topic in topics:
                        <option ${"selected" if topic['id'] in selected_values['topics'] else ""} value="${topic['id']}">${topic['text']}</option>
                      %endfor
                  </select>

                  <span class="tip" id="tip-topics">${_("The Topics to include or exclude from the timed exam.")} ${_("This cannot be changed.")}</span>
                  <span class="tip tip-error is-hiding" id="tip-error-topics"></span>
                </li>

                <li class="field text learning_output-input">
                  <label for="learning_output">${_("Learning Outcome")}</label>

                  <input class="learning_output_include_exclude" type="radio" id="learning_output_include_all" name="learning_output_include_exclude" checked value="all" ${"checked" if timed_exam_model_instance.learning_output_include_exclude == "all" else ""}>
                  <label class="learning_output_include_exclude" for="learning_output_include_all">${_("All")}</label>
                  &nbsp;&nbsp;&nbsp;
                  <input class="learning_output_include_exclude" type="radio" id="learning_output_include" name="learning_output_include_exclude" value="include" ${"checked" if timed_exam_model_instance.learning_output_include_exclude == "include" else ""}>
                  <label class="learning_output_include_exclude" for="learning_output_include">${_("Include")}</label>
                  &nbsp;&nbsp;&nbsp;

                  <input class="learning_output_include_exclude" type="radio" id="learning_output_exclude" name="learning_output_include_exclude" value="exclude" ${"checked" if timed_exam_model_instance.learning_output_include_exclude == "exclude" else ""}>
                  <label class="learning_output_include_exclude" for="learning_output_exclude">${_("Exclude")}</label>
                  &nbsp;&nbsp;&nbsp;

                  <select class="learning_output select2" id="learning_output" multiple="multiple data-placeholder="${_('Learning Outcome to include or exclude')}" name="learning_output[]" aria-describedby="tip-learning_output tip-error-learning_output">
                      <option></option>
                      %for learning_output in learning_outputs:
                        <option ${"selected" if learning_output['id'] in selected_values['learning_output'] else ""} value="${learning_output['id']}">${learning_output['text']}</option>
                      %endfor
                  </select>

                  <span class="tip" id="tip-learning_output">${_("The Learning Outcome to include or exclude from the timed exam.")} ${_("This cannot be changed.")}</span>
                  <span class="tip tip-error is-hiding" id="tip-error-learning_output"></span>
                </li>

              </ol>

            </fieldset>
          </div>

          <div class="actions">
            <input type="hidden" value="true" class="allow-unicode-course-id" />
            <input type="hidden" value="${timed_exam_key_string}" name="timed_exam_key_string" class="timed_exam_key_string" />
            <input type="submit" value="${_('Update')}" class="action action-primary update-timed-exam" />
            <input type="button" value="${_('Cancel')}" class="action action-secondary action-cancel new-timed-exam-cancel" />
          </div>
        </form>
      </div>

    </article>
    <aside class="content-supplementary" role="complementary">
      <div class="bit">
        <h3 class="title title-3">${_('New to {studio_name}?').format(studio_name=settings.STUDIO_NAME)}</h3>
        <p>${_('Click Help in the upper-right corner to get more information about the {studio_name} page you are viewing. You can also use the links at the bottom of the page to access our continually updated documentation and other {studio_name} resources.').format(studio_name=settings.STUDIO_SHORT_NAME)}</p>

<!--        <ol class="list-actions">-->
<!--          <li class="action-item">-->

<!--            <a href="${get_online_help_info(online_help_token())['doc_url']}" rel="noopener" target="_blank">${_("Getting Started with {studio_name}").format(studio_name=settings.STUDIO_NAME)}</a>-->
<!--          </li>-->
<!--        </ol>-->
      </div>

      % if course_creator_status=='disallowed_for_this_site' and settings.FEATURES.get('STUDIO_REQUEST_EMAIL',''):
      <div class="bit">
        <h3 class="title title-3">${_("Can I create courses in {studio_name}?").format(studio_name=settings.STUDIO_NAME)}</h3>
        <p>${Text(_("In order to create courses in {studio_name}, you must {link_start}contact {platform_name} staff to help you create a course{link_end}.")).format(
            studio_name=settings.STUDIO_NAME,
            platform_name=settings.PLATFORM_NAME,
            link_start=HTML('<a href="mailto:{email}">').format(email=settings.FEATURES.get('STUDIO_REQUEST_EMAIL','')),
            link_end=HTML("</a>"),
          )}</p>
      </div>
      % endif

      % if course_creator_status == "unrequested":
      <div class="bit">
        <h3 class="title title-3">${_("Can I create courses in {studio_name}?").format(studio_name=settings.STUDIO_NAME)}</h3>
        <p>${_('In order to create courses in {studio_name}, you must have course creator privileges to create your own course.').format(studio_name=settings.STUDIO_NAME)}</p>
      </div>

      % elif course_creator_status == "denied":
      <div class="bit">
        <h3 class="title title-3">${_("Can I create courses in {studio_name}?").format(studio_name=settings.STUDIO_NAME)}</h3>
        <p>${Text(_("Your request to author courses in {studio_name} has been denied. Please {link_start}contact {platform_name} Staff with further questions{link_end}.")).format(
            studio_name=settings.STUDIO_NAME,
            platform_name=settings.PLATFORM_NAME,
            link_start=HTML('<a href="mailto:{email}">').format(email=settings.TECH_SUPPORT_EMAIL),
            link_end=HTML('</a>'),
          )}</p>
      </div>

      % endif
    </aside>
  </section>


  % else:
  <section class="content">
    <article class="content-primary" role="main">
      <div class="introduction">
        <h2 class="title">${_("Thanks for signing up, {name}!").format(name=user.username)}</h2>
      </div>

      <div class="notice notice-incontext notice-instruction notice-instruction-verification">
        <div class="msg">
          <h3 class="title">${_("We need to verify your email address")}</h3>
          <div class="copy">
            <p>${_('Almost there! In order to complete your sign up we need you to verify your email address ({email}). An activation message and next steps should be waiting for you there.').format(email=user.email)}</p>
          </div>
        </div>
      </div>
    </article>

    <aside class="content-supplementary" role="complementary">
      <div class="bit">
        <h3 class="title title-3">${_('Need help?')}</h3>
        <p>${_('Please check your Junk or Spam folders in case our email isn\'t in your INBOX. Still can\'t find the verification email? Request help via the link below.')}</p>
      </div>
    </aside>
  </section>

  %endif
</div>
</%block>
